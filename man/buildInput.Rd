% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/buildInput.R
\name{buildInput}
\alias{buildInput}
\title{Build input file for coverage analysis}
\usage{
buildInput(
  geneList,
  genome,
  chromosome_notation,
  sampleList,
  outDir,
  type_input,
  MAPQ.min = 1,
  base.quality = 1,
  type_coverage = "bam",
  input_coord_system = "1-based",
  annotation_file = NULL
)
}
\arguments{
\item{geneList}{A text file (.txt) containing HGNC official gene name(s) one per row,
or a BED file with genomic coordinates (chr, start, end, SYMBOL)}

\item{genome}{(char) Reference genome: "hg19" or "hg38"}

\item{chromosome_notation}{(char) Chromosome notation: "chr" (chr1,chr2,...,chrX,chrM) or 
"number" (1,2,...,X,M)}

\item{sampleList}{A text file (.list) containing absolute paths to coverage files 
(BAM or BED) one per row}

\item{outDir}{(char) Directory where output files will be stored}

\item{type_input}{(char) Type of input target: "genes" (gene list) or "target" (BED file)}

\item{MAPQ.min}{(integer) **[BAM only]** Minimum mapping quality for alignments (default: 1). 
Ignored when `type_coverage = "bed"`}

\item{base.quality}{(integer) **[BAM only]** Minimum base quality for nucleotides (default: 1).
Ignored when `type_coverage = "bed"`}

\item{type_coverage}{(char) Type of coverage files: "bam" or "bed" (default: "bam")}

\item{input_coord_system}{(char) **[BED only]** Coordinate system of input BED coverage files: 
"0-based" (BED standard) or "1-based" (IGV/VCF). Default: "1-based". 
Ignored when `type_coverage = "bam"` (BAM is always 1-based)}

\item{annotation_file}{(char) Optional path to annotation file (tab-separated 
with SYMBOL column for adding gene-level annotations)}
}
\value{
Two files: 
1. A .bed file containing tab-separated genomic coordinates (chromosome, start, end)
   with coverage values for each position
2. A .txt file with statistical summary of coverage per gene and sample
}
\description{
Function to build input file for coverage analysis with optimized processing
and support for both BAM and BED coverage files.
}
\details{
**Coverage File Types:**

- **BAM files** (`type_coverage = "bam"`): 
  - Requires `MAPQ.min` and `base.quality` parameters
  - Automatically uses 1-based coordinates
  - Generates per-base coverage via samtools pileup
  
- **BED coverage files** (`type_coverage = "bed"`):
  - Requires `input_coord_system` parameter ("0-based" or "1-based")
  - `MAPQ.min` and `base.quality` are ignored
  - Faster processing for pre-computed coverage
  - Expected format: chromosome, start, end, coverage_depth
}
\examples{
\dontrun{
# Example 1: Process BAM files
gene_list <- system.file("extdata", "mygene.txt", package = "uncoverappLib")
bam_example <- system.file("extdata", "example_POLG.bam", package = "uncoverappLib")
cat(bam_example, file = "bam.list", sep = "\n")

buildInput(
  geneList = gene_list, 
  genome = "hg19", 
  chromosome_notation = "chr",
  sampleList = "bam.list",
  type_input = "genes", 
  outDir = tempdir(),
  type_coverage = "bam",
  MAPQ.min = 20,
  base.quality = 20
)

# Example 2: Process BED coverage files
buildInput(
  geneList = gene_list,
  genome = "hg38",
  chromosome_notation = "chr",
  sampleList = "coverage.list",
  type_input = "genes",
  outDir = tempdir(),
  type_coverage = "bed",
  input_coord_system = "0-based"
)
}
}
