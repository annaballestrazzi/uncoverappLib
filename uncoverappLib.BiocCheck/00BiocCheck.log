Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage...
'LazyData:' in the 'DESCRIPTION' should be set to false or removed
Checking version number... OK
Checking version number validity... OK
Checking R version dependency... OK
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews...
Consider adding these automatically suggested biocViews: VariantAnnotation
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer...
Consider adding the maintainer's ORCID iD in 'Authors@R' with 'comment=c(ORCID="...")'
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies... OK
Checking for pinned package versions in DESCRIPTION... OK
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders... OK
Checking vignette directory...
Evaluate more vignette chunks.
Checking package installation calls in R code... OK
Checking for library/require of uncoverappLib... OK
Checking coding practice...
 Avoid sapply(); use vapply()
Found in files:
R/buildAnnotation.R (line 217, column 19)
R/buildAnnotation.R (line 286, column 21)
R/buildAnnotation.R (line 313, column 20)
R/buildInput.R (line 340, column 27)
R/buildInput.R (line 520, column 24)
R/buildInput.R (line 628, column 23)
 Avoid 1:...; use seq_len() or seq_along()
Found in files:
buildAnnotation.R (line 335, column 35)
buildAnnotation.R (line 466, column 39)
buildAnnotation.R (line 471, column 33)
buildAnnotation.R (line 632, column 35)
buildInput.R (line 196, column 30)
buildInput.R (line 449, column 18)
buildInput.R (line 583, column 19)
buildInput.R (line 586, column 32)
buildInput.R (line 593, column 20)
buildInput.R (line 621, column 25)
buildInput.R (line 751, column 39)
setup.R (line 47, column 13)
 Avoid 'cat' and 'print' outside of 'show' methods
Found in files:
cat() in R/buildAnnotation.R (line 78, column 3)
cat() in R/buildAnnotation.R (line 79, column 3)
cat() in R/buildAnnotation.R (line 80, column 3)
cat() in R/buildAnnotation.R (line 81, column 3)
cat() in R/buildAnnotation.R (line 82, column 3)
cat() in R/buildAnnotation.R (line 83, column 3)
cat() in R/buildAnnotation.R (line 84, column 3)
cat() in R/buildAnnotation.R (line 90, column 3)
cat() in R/buildAnnotation.R (line 104, column 3)
cat() in R/buildAnnotation.R (line 105, column 3)
cat() in R/buildAnnotation.R (line 107, column 3)
cat() in R/buildAnnotation.R (line 115, column 3)
cat() in R/buildAnnotation.R (line 121, column 5)
cat() in R/buildAnnotation.R (line 128, column 7)
cat() in R/buildAnnotation.R (line 136, column 7)
cat() in R/buildAnnotation.R (line 146, column 7)
cat() in R/buildAnnotation.R (line 148, column 9)
cat() in R/buildAnnotation.R (line 149, column 9)
cat() in R/buildAnnotation.R (line 159, column 3)
cat() in R/buildAnnotation.R (line 165, column 3)
cat() in R/buildAnnotation.R (line 184, column 3)
cat() in R/buildAnnotation.R (line 185, column 3)
cat() in R/buildAnnotation.R (line 187, column 3)
cat() in R/buildAnnotation.R (line 192, column 3)
cat() in R/buildAnnotation.R (line 198, column 3)
cat() in R/buildAnnotation.R (line 201, column 3)
cat() in R/buildAnnotation.R (line 209, column 3)
cat() in R/buildAnnotation.R (line 213, column 5)
cat() in R/buildAnnotation.R (line 218, column 5)
cat() in R/buildAnnotation.R (line 236, column 5)
cat() in R/buildAnnotation.R (line 248, column 3)
cat() in R/buildAnnotation.R (line 254, column 3)
cat() in R/buildAnnotation.R (line 276, column 3)
cat() in R/buildAnnotation.R (line 278, column 3)
cat() in R/buildAnnotation.R (line 287, column 3)
cat() in R/buildAnnotation.R (line 289, column 3)
cat() in R/buildAnnotation.R (line 294, column 5)
cat() in R/buildAnnotation.R (line 304, column 3)
cat() in R/buildAnnotation.R (line 319, column 3)
cat() in R/buildAnnotation.R (line 326, column 3)
cat() in R/buildAnnotation.R (line 349, column 3)
cat() in R/buildAnnotation.R (line 357, column 3)
cat() in R/buildAnnotation.R (line 372, column 3)
cat() in R/buildAnnotation.R (line 375, column 5)
cat() in R/buildAnnotation.R (line 405, column 3)
cat() in R/buildAnnotation.R (line 406, column 3)
cat() in R/buildAnnotation.R (line 418, column 3)
cat() in R/buildAnnotation.R (line 419, column 3)
cat() in R/buildAnnotation.R (line 427, column 5)
cat() in R/buildAnnotation.R (line 430, column 3)
cat() in R/buildAnnotation.R (line 434, column 3)
cat() in R/buildAnnotation.R (line 435, column 3)
cat() in R/buildAnnotation.R (line 441, column 3)
cat() in R/buildAnnotation.R (line 445, column 3)
cat() in R/buildAnnotation.R (line 448, column 3)
cat() in R/buildAnnotation.R (line 644, column 3)
cat() in R/buildAnnotation.R (line 645, column 3)
cat() in R/buildAnnotation.R (line 650, column 3)
cat() in R/buildAnnotation.R (line 651, column 3)
print() in R/buildAnnotation.R (line 199, column 3)
cat() in R/buildInput.R (line 788, column 3)
cat() in R/getAnnotationFiles.R (line 19, column 5)
cat() in R/getAnnotationFiles.R (line 20, column 5)
cat() in R/getAnnotationFiles.R (line 30, column 18)
cat() in R/getAnnotationFiles.R (line 52, column 18)
cat() in R/getAnnotationFiles.R (line 58, column 5)
cat() in R/getAnnotationFiles.R (line 59, column 5)
cat() in R/getAnnotationFiles.R (line 75, column 18)
cat() in R/getAnnotationFiles.R (line 82, column 20)
cat() in R/getAnnotationFiles.R (line 93, column 18)
cat() in R/getAnnotationFiles.R (line 108, column 5)
cat() in R/getAnnotationFiles.R (line 109, column 5)
print() in R/getAnnotationFiles.R (line 110, column 5)
cat() in R/setup.R (line 20, column 3)
cat() in R/setup.R (line 21, column 3)
cat() in R/setup.R (line 22, column 3)
cat() in R/setup.R (line 23, column 3)
cat() in R/setup.R (line 33, column 5)
cat() in R/setup.R (line 34, column 5)
cat() in R/setup.R (line 36, column 7)
cat() in R/setup.R (line 38, column 5)
cat() in R/setup.R (line 42, column 3)
cat() in R/setup.R (line 43, column 3)
cat() in R/setup.R (line 57, column 3)
cat() in R/setup.R (line 58, column 3)
cat() in R/setup.R (line 80, column 5)
cat() in R/setup.R (line 87, column 5)
cat() in R/setup.R (line 89, column 5)
cat() in R/setup.R (line 91, column 7)
cat() in R/setup.R (line 93, column 5)
 Avoid the use of 'paste' in condition signals
Found in files:
R/buildInput.R (line 198, column 13)
R/buildInput.R (line 202, column 13)
R/buildInput.R (line 207, column 11)
R/buildInput.R (line 215, column 11)
R/buildInput.R (line 217, column 11)
R/buildInput.R (line 229, column 11)
R/buildInput.R (line 264, column 15)
R/buildInput.R (line 271, column 13)
R/buildInput.R (line 293, column 15)
R/buildInput.R (line 303, column 13)
R/buildInput.R (line 304, column 13)
R/buildInput.R (line 373, column 11)
R/buildInput.R (line 374, column 11)
R/buildInput.R (line 385, column 11)
R/buildInput.R (line 411, column 13)
R/buildInput.R (line 412, column 13)
R/buildInput.R (line 413, column 13)
R/buildInput.R (line 414, column 13)
R/buildInput.R (line 436, column 15)
R/buildInput.R (line 461, column 13)
R/buildInput.R (line 469, column 15)
R/buildInput.R (line 479, column 15)
R/buildInput.R (line 492, column 17)
R/buildInput.R (line 516, column 15)
R/buildInput.R (line 558, column 15)
R/buildInput.R (line 564, column 15)
R/buildInput.R (line 570, column 11)
R/buildInput.R (line 571, column 11)
R/buildInput.R (line 679, column 11)
R/buildInput.R (line 691, column 13)
R/buildInput.R (line 694, column 15)
R/buildInput.R (line 708, column 19)
R/buildInput.R (line 718, column 19)
R/buildInput.R (line 723, column 17)
R/buildInput.R (line 769, column 11)
R/buildInput.R (line 783, column 11)
Avoid redundant 'stop' and 'warn*' in signal conditions
Found in files:
R/buildAnnotation.R (line 101, column 10)
R/buildAnnotation.R (line 272, column 10)
R/buildAnnotation.R (line 283, column 10)
R/buildInput.R (line 268, column 12)
R/buildInput.R (line 300, column 12)
R/buildInput.R (line 523, column 12)
R/buildInput.R (line 723, column 23)
 Avoid system() ; use system2()
Found in files:
system() in R/buildInput.R (line 403, column 18)
Checking parsed R code in R directory, examples, vignettes...
Avoid 'suppressWarnings'/'*Messages' if possible (found 2 times)
suppressWarnings() in R/buildAnnotation.R (line 343, column 23)
suppressWarnings() in R/buildAnnotation.R (line 346, column 23)
Checking function lengths...
The recommended function length is 50 lines or less. There are 4 functions greater than 50 lines.
The longest 5 functions are:
buildInput() (R/buildInput.R): 666 lines
buildAnnotation() (R/buildAnnotation.R): 613 lines
getAnnotationFiles() (R/getAnnotationFiles.R): 102 lines
_anonymous_.467() (R/buildInput.R):  52 lines
Checking man page documentation...
Consider adding runnable examples to man pages that document exported objects.
getAnnotationFiles.Rd
Usage of dontrun{} / donttest{} tags found in man page examples. 67% of man pages use at least one of these tags.
Found in files:
buildAnnotation.Rd
buildInput.Rd
getAnnotationFiles.Rd
setup_uncoverapp.Rd
uncoverAPP.Rd
uncoverappLib.run.Rd
Use donttest{} instead of dontrun{}.
Found in files:
buildAnnotation.Rd
buildInput.Rd
getAnnotationFiles.Rd
setup_uncoverapp.Rd
uncoverAPP.Rd
uncoverappLib.run.Rd
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 107 lines (4%) are > 80 characters long.
First few lines:
R/buildAnnotation.R#L4 #' This function identifies ALL genomic  ...
R/buildAnnotation.R#L5 #' and annotates them with variant infor ...
R/buildAnnotation.R#L11 #' @param annotation_file Character or N ...
R/buildAnnotation.R#L51   # ==================================== ...
R/buildAnnotation.R#L53   # ==================================== ...
R/buildAnnotation.R#L74   # ==================================== ...
R/buildAnnotation.R#L76   # ==================================== ...
R/buildAnnotation.R#L86   # ==================================== ...
R/buildAnnotation.R#L88   # ==================================== ...
R/buildAnnotation.R#L111   # ==================================== ...
R/buildAnnotation.R#L113   # ==================================== ...
R/buildAnnotation.R#L136       cat("Found target sample after rem ...
R/buildAnnotation.R#L148         cat("WARNING: Multiple matches f ...
R/buildAnnotation.R#L161   # ==================================== ...
R/buildAnnotation.R#L163   # ==================================== ...
R/buildAnnotation.R#L187   cat("Chromosomes in data:", paste(uniq ...
R/buildAnnotation.R#L192   cat("After coverage filter (<=", cover ...
R/buildAnnotation.R#L205   # ==================================== ...
R/buildAnnotation.R#L207   # ==================================== ...
R/buildAnnotation.R#L216     m <- uncoverappLib::getAnnotationFil ...
R/buildAnnotation.R#L222     #if (identical(genome, "hg19") && nz ...
R/buildAnnotation.R#L224     #} else if (identical(genome, "hg38" ...
R/buildAnnotation.R#L233       stop("Could not find annotation fi ...
R/buildAnnotation.R#L250   # ==================================== ...
R/buildAnnotation.R#L252   # ==================================== ...
R/buildAnnotation.R#L280   result <- try(Rsamtools::scanTabix(fil ...
R/buildAnnotation.R#L300   # ==================================== ...
R/buildAnnotation.R#L302   # ==================================== ...
R/buildAnnotation.R#L321   # ==================================== ...
R/buildAnnotation.R#L323   # ==================================== ...
R/buildAnnotation.R#L353   # ==================================== ...
R/buildAnnotation.R#L355   # ==================================== ...
R/buildAnnotation.R#L370   tp <- GenomicRanges::findOverlaps(quer ...
R/buildAnnotation.R#L401   # ==================================== ...
R/buildAnnotation.R#L403   # ==================================== ...
R/buildAnnotation.R#L412       ClinVar != ".",                    ...
R/buildAnnotation.R#L421   if (all(c("MutationAssessor", "ClinVar ...
R/buildAnnotation.R#L422     intersect_df$highlight_important <-  ...
R/buildAnnotation.R#L427     cat("Important variants:", sum(inter ...
R/buildAnnotation.R#L437   # ==================================== ...
R/buildAnnotation.R#L439   # ==================================== ...
R/buildAnnotation.R#L632                            cols = 1:min( ...
R/buildAnnotation.R#L650   cat("Total script execution:",round(di ...
R/buildInput.R#L28 #' 1. A .bed file containing tab-separat ...
R/buildInput.R#L32 #' @param geneList A text file (.txt) co ...
R/buildInput.R#L35 #' @param chromosome_notation (char) Chr ...
R/buildInput.R#L37 #' @param sampleList A text file (.list) ...
R/buildInput.R#L40 #' @param type_input (char) Type of inpu ...
R/buildInput.R#L41 #' @param type_coverage (char) Type of c ...
R/buildInput.R#L42 #' @param MAPQ.min (integer) **[BAM only ...
R/buildInput.R#L44 #' @param base.quality (integer) **[BAM  ...
R/buildInput.R#L46 #' @param input_coord_system (char) **[B ...
R/buildInput.R#L49 #' @param annotation_file (char) Optiona ...
R/buildInput.R#L61 #' @importFrom dplyr filter group_by sum ...
R/buildInput.R#L145   # ==================================== ...
R/buildInput.R#L147   # ==================================== ...
R/buildInput.R#L160   # ==================================== ...
R/buildInput.R#L162   # ==================================== ...
R/buildInput.R#L185   # ==================================== ...
R/buildInput.R#L187   # ==================================== ...
R/buildInput.R#L211     all_gene <- TxDb.Hsapiens.UCSC.hg19. ...
R/buildInput.R#L213     all_gene <- TxDb.Hsapiens.UCSC.hg38. ...
R/buildInput.R#L218                 round(difftime(Sys.time( ...
R/buildInput.R#L220   # ==================================== ...
R/buildInput.R#L222   # ==================================== ...
R/buildInput.R#L231   # ==================================== ...
R/buildInput.R#L233   # ==================================== ...
R/buildInput.R#L314   # ==================================== ...
R/buildInput.R#L316   # ==================================== ...
R/buildInput.R#L348       dplyr::inner_join(my_gene_name, by ...
R/buildInput.R#L378   # ==================================== ...
R/buildInput.R#L380   # ==================================== ...
R/buildInput.R#L403     idx_stats <- system(paste("samtools  ...
R/buildInput.R#L405                          col.names = c(" ...
R/buildInput.R#L437       pileup_df <- Rsamtools::pileup(i,  ...
R/buildInput.R#L447     pp <- Reduce(function(...) merge(... ...
R/buildInput.R#L453     pp_gr <- GenomicRanges::makeGRangesF ...
R/buildInput.R#L454     overlaps <- GenomicRanges::findOverl ...
R/buildInput.R#L456     mcols(pp_gr_matched)$SYMBOL <- for_g ...
R/buildInput.R#L488       df_gr <- GenomicRanges::makeGRange ...
R/buildInput.R#L559       message("First 20 missing genes:", ...
R/buildInput.R#L570   message(paste("Final coverage dimensio ...
R/buildInput.R#L572                 round(difftime(Sys.time( ...
R/buildInput.R#L575   # ==================================== ...
R/buildInput.R#L577   # ==================================== ...
R/buildInput.R#L665         Mean_coverage = sum(value * widt ...
R/buildInput.R#L683   # ==================================== ...
R/buildInput.R#L685   # ==================================== ...
R/buildInput.R#L706           warning("Annotation file must  ...
R/buildInput.R#L719                        round(difftime(Sy ...
R/buildInput.R#L728   # ==================================== ...
R/buildInput.R#L730   # ==================================== ...
R/buildInput.R#L751   count_cols <- colnames(pp_output)[-(1: ...
R/buildInput.R#L788   cat("Total script execution:",round(di ...
R/getAnnotationFiles.R#L68     download.file(url, local_path, mode  ...
R/run.uncoverapp.R#L3 #' Launches \code{unCOVERApp}, a \code{S ...
R/run.uncoverapp.R#L4 #' The app can be launched in different  ...
R/run.uncoverapp.R#L63     stop("Could not find shiny app direc ...
R/run.uncoverapp.R#L74 #' @param where Character. One of \code{ ...
R/run.uncoverapp.R#L104 #' @param where Character. One of \code{ ...
vignettes/uncoverapp_introduction.Rmd#L26 **uncoverappLib** is an interactive Shin ...
vignettes/uncoverapp_introduction.Rmd#L31 - **Clinical Annotations**: Integrate db ...
vignettes/uncoverapp_introduction.Rmd#L33 - **Statistical Tools**: Binomial probab ...
vignettes/uncoverapp_introduction.Rmd#L298 > Pippucci T, Iovino E, et al. (2020). u ...
vignettes/uncoverapp_technical.Rmd#L10   %\VignetteIndexEntry{Technical Guide:  ...
vignettes/uncoverapp_technical.Rmd#L24 This vignette provides technical details ...
vignettes/uncoverapp_technical.Rmd#L561 sample_comparison$difference <- sample_c ...
Consider multiples of 4 spaces for line indents; 1140 lines (40%) are not.
First few lines:
R/buildAnnotation.R#L42                                target_sa ...
R/buildAnnotation.R#L43                                coverage_ ...
R/buildAnnotation.R#L44                                genome =  ...
R/buildAnnotation.R#L45                                annotatio ...
R/buildAnnotation.R#L46                                output_in ...
R/buildAnnotation.R#L47                                output_fo ...
R/buildAnnotation.R#L50    ...
R/buildAnnotation.R#L51   # ==================================== ...
R/buildAnnotation.R#L52   # INPUT VALIDATION ...
R/buildAnnotation.R#L53   # ==================================== ...
R/buildAnnotation.R#L54    ...
R/buildAnnotation.R#L55   if (missing(sample_data)) stop("sample ...
R/buildAnnotation.R#L56   if (missing(target_sample)) stop("targ ...
R/buildAnnotation.R#L57    ...
R/buildAnnotation.R#L58   if (!genome %in% c("hg19", "hg38")) { ...
R/buildAnnotation.R#L60   } ...
R/buildAnnotation.R#L61   # Packages loaded via NAMESPACE import ...
R/buildAnnotation.R#L62   # No explicit library() calls needed ...
R/buildAnnotation.R#L64   # # Load required packages ...
R/buildAnnotation.R#L65   # suppressPackageStartupMessages({ ...
R/buildAnnotation.R#L66   #   require(dplyr) ...
R/buildAnnotation.R#L67   #   require(GenomicRanges) ...
R/buildAnnotation.R#L68   #   require(IRanges) ...
R/buildAnnotation.R#L69   #   require(Rsamtools) ...
R/buildAnnotation.R#L70   #   require(S4Vectors) ...
R/buildAnnotation.R#L71   #   require(openxlsx) ...
R/buildAnnotation.R#L72   # }) ...
R/buildAnnotation.R#L73    ...
R/buildAnnotation.R#L74   # ==================================== ...
R/buildAnnotation.R#L75   # CONFIGURATION ...
R/buildAnnotation.R#L76   # ==================================== ...
R/buildAnnotation.R#L77    ...
R/buildAnnotation.R#L78   cat("\n=== ANNOTATING ALL LOW COVERAGE ...
R/buildAnnotation.R#L79   cat("Sample data:", sample_data, "\n") ...
R/buildAnnotation.R#L80   cat("Target sample:", target_sample, " ...
R/buildAnnotation.R#L81   cat("Coverage threshold:", coverage_th ...
R/buildAnnotation.R#L82   cat("Genome:", genome, "\n") ...
R/buildAnnotation.R#L83   cat("Output intersect:", output_inters ...
R/buildAnnotation.R#L84   cat("Output formatted:", output_format ...
R/buildAnnotation.R#L85    ...
R/buildAnnotation.R#L86   # ==================================== ...
R/buildAnnotation.R#L87   # STEP 1: LOAD INPUT DATA ...
R/buildAnnotation.R#L88   # ==================================== ...
R/buildAnnotation.R#L89    ...
R/buildAnnotation.R#L90   cat("=== STEP 1: LOADING INPUT DATA == ...
R/buildAnnotation.R#L91   start_time <- Sys.time() ...
R/buildAnnotation.R#L92    ...
R/buildAnnotation.R#L93   if (!file.exists(sample_data)) { ...
R/buildAnnotation.R#L95   } ...
R/buildAnnotation.R#L96    ...
R/buildAnnotation.R#L97   df <- tryCatch({ ...
R/buildAnnotation.R#L99                stringsAsFactors = FALSE, ...
R/buildAnnotation.R#L100   }, error = function(e) { ...
R/buildAnnotation.R#L102   }) ...
R/buildAnnotation.R#L103    ...
R/buildAnnotation.R#L104   cat("Loaded", nrow(df), "rows x", ncol ...
R/buildAnnotation.R#L105   cat("Column names:", paste(colnames(df ...
R/buildAnnotation.R#L106    ...
R/buildAnnotation.R#L107   cat(paste("Input loading took:",  ...
R/buildAnnotation.R#L110    ...
R/buildAnnotation.R#L111   # ==================================== ...
R/buildAnnotation.R#L112   # STEP 2: FIND ACTUAL COLUMN NAME ...
R/buildAnnotation.R#L113   # ==================================== ...
R/buildAnnotation.R#L114    ...
R/buildAnnotation.R#L115   cat("=== STEP 2: IDENTIFYING TARGET CO ...
R/buildAnnotation.R#L116    ...
R/buildAnnotation.R#L117   actual_column <- NULL ...
R/buildAnnotation.R#L118    ...
R/buildAnnotation.R#L119   if (target_sample %in% colnames(df)) { ...
R/buildAnnotation.R#L122   } ...
R/buildAnnotation.R#L123    ...
R/buildAnnotation.R#L124   if (is.null(actual_column)) { ...
R/buildAnnotation.R#L127       actual_column <- with_prefix ...
R/buildAnnotation.R#L128       cat("Found target sample with 'cou ...
R/buildAnnotation.R#L130   } ...
R/buildAnnotation.R#L131    ...
R/buildAnnotation.R#L132   if (is.null(actual_column)) { ...
R/buildAnnotation.R#L135       actual_column <- without_prefix ...
R/buildAnnotation.R#L136       cat("Found target sample after rem ...
R/buildAnnotation.R#L138   } ...
R/buildAnnotation.R#L139    ...
R/buildAnnotation.R#L140   if (is.null(actual_column)) { ...
R/buildAnnotation.R#L145       actual_column <- matches[1] ...
R/buildAnnotation.R#L146       cat("Found partial match for targe ...
R/buildAnnotation.R#L147       if (length(matches) > 1) { ...
R/buildAnnotation.R#L150       } ...
R/buildAnnotation.R#L152   } ...
R/buildAnnotation.R#L153    ...
R/buildAnnotation.R#L154   if (is.null(actual_column)) { ...
R/buildAnnotation.R#L156          "Available columns: ", paste(co ...
R/buildAnnotation.R#L157   } ...
R/buildAnnotation.R#L158    ...
R/buildAnnotation.R#L159   cat("Using column:", actual_column, "\ ...
R/buildAnnotation.R#L160    ...
R/buildAnnotation.R#L161   # ==================================== ...
R/buildAnnotation.R#L162   # STEP 3: PREPARE COVERAGE DATA (ALL P ...
R/buildAnnotation.R#L163   # ==================================== ...
R/buildAnnotation.R#L164    ...
R/buildAnnotation.R#L165   cat("=== STEP 3: PREPARING COVERAGE DA ...
R/buildAnnotation.R#L166   prep_time <- Sys.time() ...
R/buildAnnotation.R#L167    ...
R/buildAnnotation.R#L168   if (!"start" %in% colnames(df)) { ...
R/buildAnnotation.R#L170   } ...
R/buildAnnotation.R#L171   if (!"chromosome" %in% colnames(df)) { ...
R/buildAnnotation.R#L173   } ...
R/buildAnnotation.R#L174    ...
R/buildAnnotation.R#L175   # Create bedA with all data ...
R/buildAnnotation.R#L176   bedA <- data.frame( ...
R/buildAnnotation.R#L182   ) ...
R/buildAnnotation.R#L183    ...
R/buildAnnotation.R#L184   cat("Total positions in data:", nrow(b ...
R/buildAnnotation.R#L185   cat("Coverage range:", min(bedA$covera ...
R/buildAnnotation.R#L186       max(bedA$coverage, na.rm = TRUE),  ...
R/buildAnnotation.R#L187   cat("Chromosomes in data:", paste(uniq ...
R/buildAnnotation.R#L188    ...
R/buildAnnotation.R#L189   bedA <- bedA %>% ...
R/buildAnnotation.R#L191    ...
R/buildAnnotation.R#L192   cat("After coverage filter (<=", cover ...
R/buildAnnotation.R#L193    ...
R/buildAnnotation.R#L194   if (nrow(bedA) == 0) { ...
R/buildAnnotation.R#L196   } ...
R/buildAnnotation.R#L197    ...
R/buildAnnotation.R#L198   cat("Sample of filtered data:\n") ...
R/buildAnnotation.R#L199   print(head(bedA, 10)) ...
R/buildAnnotation.R#L200    ...
R/buildAnnotation.R#L201   cat(paste("\nData preparation took:", ...
R/buildAnnotation.R#L204    ...
R/buildAnnotation.R#L205   # ==================================== ...
R/buildAnnotation.R#L206   # STEP 4: SELECT ANNOTATION FILE ...
R/buildAnnotation.R#L207   # ==================================== ...
R/buildAnnotation.R#L208    ...
R/buildAnnotation.R#L209   cat("=== STEP 4: SELECTING ANNOTATION  ...
R/buildAnnotation.R#L210    ...
R/buildAnnotation.R#L211   if (!is.null(annotation_file) && file. ...
R/buildAnnotation.R#L214   } else {   ...
R/buildAnnotation.R#L233       stop("Could not find annotation fi ...
R/buildAnnotation.R#L237   } ...
R/buildAnnotation.R#L238    ...
R/buildAnnotation.R#L239   if (!file.exists(file.name)) { ...
R/buildAnnotation.R#L241   } ...
R/buildAnnotation.R#L242    ...
R/buildAnnotation.R#L243   index_file <- paste0(file.name, ".tbi" ...
R/buildAnnotation.R#L244   if (!file.exists(index_file)) { ...
R/buildAnnotation.R#L246   } ...
R/buildAnnotation.R#L247    ...
R/buildAnnotation.R#L248   cat("Index file found:", index_file, " ...
R/buildAnnotation.R#L249    ...
R/buildAnnotation.R#L250   # ==================================== ...
R/buildAnnotation.R#L251   # STEP 5: QUERY TABIX (ALL POSITIONS) ...
R/buildAnnotation.R#L252   # ==================================== ...
R/buildAnnotation.R#L253    ...
R/buildAnnotation.R#L254   cat("=== STEP 5: QUERYING TABIX FOR AL ...
R/buildAnnotation.R#L255   tabix_time <- Sys.time() ...
R/buildAnnotation.R#L256    ...
R/buildAnnotation.R#L257   bedA_for_tabix <- bedA %>% ...
R/buildAnnotation.R#L259    ...
R/buildAnnotation.R#L260   bedA_gr <- tryCatch({ ...
R/buildAnnotation.R#L262       bedA_for_tabix, ...
R/buildAnnotation.R#L263       seqnames.field = "chromosome", ...
R/buildAnnotation.R#L264       start.field = "start", ...
R/buildAnnotation.R#L265       end.field = "end", ...
R/buildAnnotation.R#L266       keep.extra.columns = FALSE, ...
R/buildAnnotation.R#L267       ignore.strand = TRUE ...
R/buildAnnotation.R#L271   }, error = function(e) { ...
R/buildAnnotation.R#L273   }) ...
R/buildAnnotation.R#L274    ...
R/buildAnnotation.R#L275   # Optimize query: merge nearby interva ...
R/buildAnnotation.R#L276   cat("Optimizing: merging", length(bedA ...
R/buildAnnotation.R#L277   reduced <- GenomicRanges::reduce(bedA_ ...
R/buildAnnotation.R#L278   cat("Reduced to", length(reduced), "in ...
R/buildAnnotation.R#L279    ...
R/buildAnnotation.R#L280   result <- try(Rsamtools::scanTabix(fil ...
R/buildAnnotation.R#L281    ...
R/buildAnnotation.R#L282   if (inherits(result, "try-error")) { ...
R/buildAnnotation.R#L284   } ...
R/buildAnnotation.R#L285    ...
R/buildAnnotation.R#L286   lengths_result <- sapply(result, lengt ...
R/buildAnnotation.R#L287   cat("Variants found:", sum(lengths_res ...
R/buildAnnotation.R#L288    ...
R/buildAnnotation.R#L289   cat(paste("Tabix query took:", ...
R/buildAnnotation.R#L292    ...
R/buildAnnotation.R#L293   if (sum(lengths_result) == 0) { ...
R/buildAnnotation.R#L298   } ...
R/buildAnnotation.R#L299    ...
R/buildAnnotation.R#L300   # ==================================== ...
R/buildAnnotation.R#L301   # STEP 6: PARSE TABIX RESULTS ...
R/buildAnnotation.R#L302   # ==================================== ...
R/buildAnnotation.R#L303    ...
R/buildAnnotation.R#L304   cat("=== STEP 6: PARSING ANNOTATION DA ...
R/buildAnnotation.R#L305   parse_time <- Sys.time() ...
R/buildAnnotation.R#L306    ...
R/buildAnnotation.R#L307   dff <- lapply(result, function(elt) { ...
R/buildAnnotation.R#L310              stringsAsFactors = FALSE) ...
R/buildAnnotation.R#L311   }) ...
R/buildAnnotation.R#L312    ...
R/buildAnnotation.R#L313   valid_dfs <- dff[sapply(dff, nrow) > 0 ...
R/buildAnnotation.R#L314   if (length(valid_dfs) == 0) { ...
R/buildAnnotation.R#L316   } ...
R/buildAnnotation.R#L317    ...
R/buildAnnotation.R#L318   bedB <- do.call(rbind, valid_dfs) ...
R/buildAnnotation.R#L319   cat("Combined annotation:", nrow(bedB) ...
R/buildAnnotation.R#L320    ...
R/buildAnnotation.R#L321   # ==================================== ...
R/buildAnnotation.R#L322   # STEP 7: PROCESS ANNOTATION ...
R/buildAnnotation.R#L323   # ==================================== ...
R/buildAnnotation.R#L324    ...
R/buildAnnotation.R#L325   ncols <- ncol(bedB) ...
R/buildAnnotation.R#L326   cat("Columns in annotation:", ncols, " ...
R/buildAnnotation.R#L327    ...
R/buildAnnotation.R#L328   if (ncols == 19) { ...
R/buildAnnotation.R#L334   } else { ...
R/buildAnnotation.R#L336   } ...
R/buildAnnotation.R#L337    ...
R/buildAnnotation.R#L338   bedB$Chromosome <- paste0("chr", bedB[ ...
R/buildAnnotation.R#L339   bedB <- bedB[, -1] ...
R/buildAnnotation.R#L340   bedB$Chromosome <- as.character(bedB$C ...
R/buildAnnotation.R#L341    ...
R/buildAnnotation.R#L342   if ("AF_gnomAD" %in% colnames(bedB)) { ...
R/buildAnnotation.R#L344   } ...
R/buildAnnotation.R#L345   if ("CADD_PHED" %in% colnames(bedB)) { ...
R/buildAnnotation.R#L347   } ...
R/buildAnnotation.R#L348    ...
R/buildAnnotation.R#L349   cat(paste("Annotation processing took: ...
R/buildAnnotation.R#L352    ...
R/buildAnnotation.R#L353   # ==================================== ...
R/buildAnnotation.R#L354   # STEP 8: COMPUTE OVERLAP ...
R/buildAnnotation.R#L355   # ==================================== ...
R/buildAnnotation.R#L356    ...
R/buildAnnotation.R#L357   cat("=== STEP 8: COMPUTING OVERLAP === ...
R/buildAnnotation.R#L358   overlap_time <- Sys.time() ...
R/buildAnnotation.R#L359    ...
R/buildAnnotation.R#L360   bed1_gr <- GenomicRanges::makeGRangesF ...
R/buildAnnotation.R#L363   ) ...
R/buildAnnotation.R#L364    ...
R/buildAnnotation.R#L365   bed2_gr <- GenomicRanges::makeGRangesF ...
R/buildAnnotation.R#L368   ) ...
R/buildAnnotation.R#L369    ...
R/buildAnnotation.R#L370   tp <- GenomicRanges::findOverlaps(quer ...
R/buildAnnotation.R#L371    ...
R/buildAnnotation.R#L372   cat("Overlaps found:", length(tp), "\n ...
R/buildAnnotation.R#L373    ...
R/buildAnnotation.R#L374   if (length(tp) == 0) { ...
R/buildAnnotation.R#L379   } ...
R/buildAnnotation.R#L380    ...
R/buildAnnotation.R#L381   hits_bed2_idx <- S4Vectors::queryHits( ...
R/buildAnnotation.R#L382   hits_bed1_idx <- S4Vectors::subjectHit ...
R/buildAnnotation.R#L383    ...
R/buildAnnotation.R#L384   bed1_hits <- bedA[hits_bed1_idx, ] ...
R/buildAnnotation.R#L385   bed2_hits <- bedB[hits_bed2_idx, ] ...
R/buildAnnotation.R#L386    ...
R/buildAnnotation.R#L387   intersect_df <- data.frame( ...
R/buildAnnotation.R#L393   ) ...
R/buildAnnotation.R#L394    ...
R/buildAnnotation.R#L395   for (col in colnames(bedB)) { ...
R/buildAnnotation.R#L397       intersect_df[[col]] <- bed2_hits[[ ...
R/buildAnnotation.R#L399   } ...
R/buildAnnotation.R#L400    ...
R/buildAnnotation.R#L401   # ==================================== ...
R/buildAnnotation.R#L402   # DEDUPLICATION: Keep only most import ...
R/buildAnnotation.R#L403   # ==================================== ...
R/buildAnnotation.R#L405   cat("\n=== DEDUPLICATING VARIANTS ===\ ...
R/buildAnnotation.R#L406   cat("Variants before deduplication:",  ...
R/buildAnnotation.R#L408   # Sort by importance (pathogenic > hig ...
R/buildAnnotation.R#L409   intersect_df <- intersect_df %>% ...
R/buildAnnotation.R#L411       seqnames, start, end, coverage, ...
R/buildAnnotation.R#L412       ClinVar != ".",                    ...
R/buildAnnotation.R#L413       desc(CADD_PHED),                   ...
R/buildAnnotation.R#L414       AF_gnomAD                          ...
R/buildAnnotation.R#L418   cat("Variants after deduplication:", n ...
R/buildAnnotation.R#L419   cat("Duplicates removed:", nrow(bed2_h ...
R/buildAnnotation.R#L421   if (all(c("MutationAssessor", "ClinVar ...
R/buildAnnotation.R#L423       intersect_df$ClinVar != "." &  ...
R/buildAnnotation.R#L424       !is.na(intersect_df$AF_gnomAD) &  ...
R/buildAnnotation.R#L425       intersect_df$AF_gnomAD < 0.5 ...
R/buildAnnotation.R#L428   } ...
R/buildAnnotation.R#L429    ...
R/buildAnnotation.R#L430   cat(paste("Overlap computation took:", ...
R/buildAnnotation.R#L433    ...
R/buildAnnotation.R#L434   cat("=== RESULTS ===\n") ...
R/buildAnnotation.R#L435   cat("Total annotated low-coverage posi ...
R/buildAnnotation.R#L436    ...
R/buildAnnotation.R#L437   # ==================================== ...
R/buildAnnotation.R#L438   # STEP 9: SAVE OUTPUT FILES ...
R/buildAnnotation.R#L439   # ==================================== ...
R/buildAnnotation.R#L440    ...
R/buildAnnotation.R#L441   cat("=== STEP 9: SAVING OUTPUT ===\n") ...
R/buildAnnotation.R#L442    ...
R/buildAnnotation.R#L443   write.table(intersect_df, output_inter ...
R/buildAnnotation.R#L444               sep = "\t", quote = FALSE, ...
R/buildAnnotation.R#L445   cat("Saved intersect output:", output_ ...
R/buildAnnotation.R#L446    ...
R/buildAnnotation.R#L447   if (grepl("\\.xlsx?$", output_formatte ...
R/buildAnnotation.R#L448   cat("Creating formatted Excel file...\ ...
R/buildAnnotation.R#L449   excel_time <- Sys.time() ...
R/buildAnnotation.R#L450    ...
R/buildAnnotation.R#L451   wb <- openxlsx::createWorkbook() ...
R/buildAnnotation.R#L452   openxlsx::addWorksheet(wb, "Low Covera ...
R/buildAnnotation.R#L453   openxlsx::writeData(wb, "Low Coverage  ...
R/buildAnnotation.R#L454    ...
R/buildAnnotation.R#L455   # ==================================== ...
R/buildAnnotation.R#L456   # HEADER STYLE ...
R/buildAnnotation.R#L457   # ==================================== ...
R/buildAnnotation.R#L458   headerStyle <- openxlsx::createStyle( ...
R/buildAnnotation.R#L464   ) ...
R/buildAnnotation.R#L465   openxlsx::addStyle(wb, "Low Coverage V ...
R/buildAnnotation.R#L466                      rows = 1, cols = 1: ...
R/buildAnnotation.R#L467    ...
R/buildAnnotation.R#L468   # Freeze header + auto-width ...
R/buildAnnotation.R#L469   openxlsx::freezePane(wb, "Low Coverage ...
R/buildAnnotation.R#L470   openxlsx::setColWidths(wb, "Low Covera ...
R/buildAnnotation.R#L471                          cols = 1:ncol(i ...
R/buildAnnotation.R#L472    ...
R/buildAnnotation.R#L473   # ==================================== ...
R/buildAnnotation.R#L474   # CONDITIONAL FORMATTING (FAST - NO LO ...
R/buildAnnotation.R#L475   # ==================================== ...
R/buildAnnotation.R#L476    ...
R/buildAnnotation.R#L477   nrows <- nrow(intersect_df) ...
R/buildAnnotation.R#L478    ...
R/buildAnnotation.R#L479   # Styles (create once, reuse) ...
R/buildAnnotation.R#L480   redStyle <- openxlsx::createStyle(fgFi ...
R/buildAnnotation.R#L481   greenStyle <- openxlsx::createStyle(fg ...
R/buildAnnotation.R#L482   yellowStyle <- openxlsx::createStyle(f ...
R/buildAnnotation.R#L483    ...
R/buildAnnotation.R#L484   # ──────────────────────────────────── ...
R/buildAnnotation.R#L485   # ClinVar: Red if pathogenic, Green if ...
R/buildAnnotation.R#L486   # ──────────────────────────────────── ...
R/buildAnnotation.R#L487   if ("ClinVar" %in% colnames(intersect_ ...
R/buildAnnotation.R#L492       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L493       cols = clinvar_col, ...
R/buildAnnotation.R#L494       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L495       rule = '!="."', ...
R/buildAnnotation.R#L496       style = redStyle ...
R/buildAnnotation.R#L501       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L502       cols = clinvar_col, ...
R/buildAnnotation.R#L503       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L504       rule = '="."', ...
R/buildAnnotation.R#L505       style = greenStyle ...
R/buildAnnotation.R#L507   } ...
R/buildAnnotation.R#L508    ...
R/buildAnnotation.R#L509   # ──────────────────────────────────── ...
R/buildAnnotation.R#L510   # CADD_PHED: Red if >20, Green if <=20 ...
R/buildAnnotation.R#L511   # ──────────────────────────────────── ...
R/buildAnnotation.R#L512   if ("CADD_PHED" %in% colnames(intersec ...
R/buildAnnotation.R#L517       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L518       cols = cadd_col, ...
R/buildAnnotation.R#L519       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L520       rule = ">20", ...
R/buildAnnotation.R#L521       style = redStyle ...
R/buildAnnotation.R#L526       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L527       cols = cadd_col, ...
R/buildAnnotation.R#L528       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L529       rule = "<=20", ...
R/buildAnnotation.R#L530       style = greenStyle ...
R/buildAnnotation.R#L532   } ...
R/buildAnnotation.R#L533    ...
R/buildAnnotation.R#L534   # ──────────────────────────────────── ...
R/buildAnnotation.R#L535   # MutationAssessor: Red for H, Yellow  ...
R/buildAnnotation.R#L536   # ──────────────────────────────────── ...
R/buildAnnotation.R#L537   if ("MutationAssessor" %in% colnames(i ...
R/buildAnnotation.R#L542       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L543       cols = ma_col, ...
R/buildAnnotation.R#L544       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L545       rule = '="H"', ...
R/buildAnnotation.R#L546       style = redStyle ...
R/buildAnnotation.R#L551       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L552       cols = ma_col, ...
R/buildAnnotation.R#L553       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L554       rule = '="M"', ...
R/buildAnnotation.R#L555       style = yellowStyle ...
R/buildAnnotation.R#L560       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L561       cols = ma_col, ...
R/buildAnnotation.R#L562       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L563       rule = 'AND($A2<>"H", $A2<>"M")',  ...
R/buildAnnotation.R#L564       style = greenStyle ...
R/buildAnnotation.R#L566   } ...
R/buildAnnotation.R#L567    ...
R/buildAnnotation.R#L568   # ──────────────────────────────────── ...
R/buildAnnotation.R#L569   # M_CAP: Red if Deleterious (D), Green ...
R/buildAnnotation.R#L570   # ──────────────────────────────────── ...
R/buildAnnotation.R#L571   if ("M_CAP" %in% colnames(intersect_df ...
R/buildAnnotation.R#L576       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L577       cols = mcap_col, ...
R/buildAnnotation.R#L578       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L579       rule = '="D"', ...
R/buildAnnotation.R#L580       style = redStyle ...
R/buildAnnotation.R#L585       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L586       cols = mcap_col, ...
R/buildAnnotation.R#L587       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L588       rule = '!="D"', ...
R/buildAnnotation.R#L589       style = greenStyle ...
R/buildAnnotation.R#L591   } ...
R/buildAnnotation.R#L592    ...
R/buildAnnotation.R#L593   # ──────────────────────────────────── ...
R/buildAnnotation.R#L594   # AF_gnomAD: Red if rare (<0.01), Gree ...
R/buildAnnotation.R#L595   # ──────────────────────────────────── ...
R/buildAnnotation.R#L596   if ("AF_gnomAD" %in% colnames(intersec ...
R/buildAnnotation.R#L601       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L602       cols = af_col, ...
R/buildAnnotation.R#L603       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L604       rule = "<0.01", ...
R/buildAnnotation.R#L605       style = redStyle ...
R/buildAnnotation.R#L610       wb, "Low Coverage Variants", ...
R/buildAnnotation.R#L611       cols = af_col, ...
R/buildAnnotation.R#L612       rows = 2:(nrows + 1), ...
R/buildAnnotation.R#L613       rule = ">=0.01", ...
R/buildAnnotation.R#L614       style = greenStyle ...
R/buildAnnotation.R#L616   } ...
R/buildAnnotation.R#L617    ...
R/buildAnnotation.R#L618   # ──────────────────────────────────── ...
R/buildAnnotation.R#L619   # BONUS: Highlight important variants  ...
R/buildAnnotation.R#L620   # ──────────────────────────────────── ...
R/buildAnnotation.R#L621   if ("highlight_important" %in% colname ...
R/buildAnnotation.R#L625       highlightStyle <- openxlsx::create ...
R/buildAnnotation.R#L626        ...
R/buildAnnotation.R#L627       # Highlight entire rows (only firs ...
R/buildAnnotation.R#L628       for (row in important_rows + 1) {  ...
R/buildAnnotation.R#L630                            highlightStyl ...
R/buildAnnotation.R#L631                            rows = row,  ...
R/buildAnnotation.R#L632                            cols = 1:min( ...
R/buildAnnotation.R#L633                            gridExpand =  ...
R/buildAnnotation.R#L634                            stack = TRUE) ...
R/buildAnnotation.R#L635       } ...
R/buildAnnotation.R#L637   } ...
R/buildAnnotation.R#L638    ...
R/buildAnnotation.R#L639   # ==================================== ...
R/buildAnnotation.R#L640   # SAVE ...
R/buildAnnotation.R#L641   # ==================================== ...
R/buildAnnotation.R#L642   openxlsx::saveWorkbook(wb, output_form ...
R/buildAnnotation.R#L643    ...
R/buildAnnotation.R#L644   cat("Saved formatted Excel:", output_f ...
R/buildAnnotation.R#L645   cat(paste("Excel formatting took:",  ...
R/buildAnnotation.R#L649    ...
R/buildAnnotation.R#L650   cat("Total script execution:",round(di ...
R/buildAnnotation.R#L651   cat("\n=== DONE ===\n") ...
R/buildAnnotation.R#L652   invisible(intersect_df) ...
R/buildAnnotation.R#L655   "ClinVar",  ...
R/buildAnnotation.R#L656   "CADD_PHED",  ...
R/buildAnnotation.R#L657   "AF_gnomAD",  ...
R/buildAnnotation.R#L658   "desc", ...
R/buildAnnotation.R#L659   "chromosome", ...
R/buildAnnotation.R#L660   "start", ...
R/buildAnnotation.R#L661   "end", ...
R/buildAnnotation.R#L662   "coverage" ...
R/buildInput.R#L2   "ENTREZID", "ALIAS", "SYMBOL", "chr",  ...
R/buildInput.R#L3   "seqnames.1", "start.1", "end.1", "wid ...
R/buildInput.R#L132                        genome,  ...
R/buildInput.R#L133                        chromosome_notati ...
R/buildInput.R#L134                        sampleList,  ...
R/buildInput.R#L135                        outDir,  ...
R/buildInput.R#L136                        type_input, ...
R/buildInput.R#L137                        MAPQ.min = 1,  ...
R/buildInput.R#L138                        base.quality = 1, ...
R/buildInput.R#L139                        type_coverage = " ...
R/buildInput.R#L140                        input_coord_syste ...
R/buildInput.R#L141                        annotation_file = ...
R/buildInput.R#L144    ...
R/buildInput.R#L145   # ==================================== ...
R/buildInput.R#L146   # INPUT VALIDATION ...
R/buildInput.R#L147   # ==================================== ...
R/buildInput.R#L148    ...
R/buildInput.R#L149   if (missing(geneList)) stop("geneList  ...
R/buildInput.R#L150   if (missing(sampleList)) stop("sampleL ...
R/buildInput.R#L151   if (MAPQ.min <= 0) stop("MAPQ.min must ...
R/buildInput.R#L152   if (base.quality <= 0) stop("base.qual ...
R/buildInput.R#L153   if (!type_coverage %in% c("bam", "bed" ...
R/buildInput.R#L155   } ...
R/buildInput.R#L156   if (!input_coord_system %in% c("0-base ...
R/buildInput.R#L158   } ...
R/buildInput.R#L159    ...
R/buildInput.R#L160   # ==================================== ...
R/buildInput.R#L161   # INITIALIZATION ...
R/buildInput.R#L162   # ==================================== ...
R/buildInput.R#L164   message("=== COVERAGE ANALYSIS STARTED ...
R/buildInput.R#L165   message(Sys.time()) ...
R/buildInput.R#L166   message("\n=== CONFIGURATION ===") ...
R/buildInput.R#L167   message("Gene file: ", geneList) ...
R/buildInput.R#L168   message("Reference genome: ", genome) ...
R/buildInput.R#L169   message("Chromosome notation: ", chrom ...
R/buildInput.R#L170   message("Sample list: ", sampleList) ...
R/buildInput.R#L171   message("Output directory: ", outDir) ...
R/buildInput.R#L172   message("Input type: ", type_input) ...
R/buildInput.R#L173   message("Coverage type: ", type_covera ...
R/buildInput.R#L174   message("Coordinate system: ", input_c ...
R/buildInput.R#L175   # Conditional parameters (only for BAM ...
R/buildInput.R#L176   if (type_coverage == "bam") { ...
R/buildInput.R#L179   } ...
R/buildInput.R#L180   # Optional annotation ...
R/buildInput.R#L181   if (!is.null(annotation_file)) { ...
R/buildInput.R#L183   } ...
R/buildInput.R#L184   message("============================= ...
R/buildInput.R#L185   # ==================================== ...
R/buildInput.R#L186   # STEP 1: LOAD INPUT FILES ...
R/buildInput.R#L187   # ==================================== ...
R/buildInput.R#L188    ...
R/buildInput.R#L189   message("\n=== STEP 1: LOADING INPUT F ...
R/buildInput.R#L190   start_time <- Sys.time() ...
R/buildInput.R#L191    ...
R/buildInput.R#L192   # Load gene list or BED file ...
R/buildInput.R#L193   if (type_input == "target") { ...
R/buildInput.R#L199   } else { ...
R/buildInput.R#L203   } ...
R/buildInput.R#L204    ...
R/buildInput.R#L205   # Load coverage file list ...
R/buildInput.R#L206   list_coverage <- base::scan(sampleList ...
R/buildInput.R#L207   message(paste("Loaded", length(list_co ...
R/buildInput.R#L208    ...
R/buildInput.R#L209   # Select genome ...
R/buildInput.R#L210   if (genome == "hg19") { ...
R/buildInput.R#L212   } else { ...
R/buildInput.R#L214   } ...
R/buildInput.R#L215   message(paste("Using genome:", genome) ...
R/buildInput.R#L216    ...
R/buildInput.R#L217   message(paste("Input loading took:",  ...
R/buildInput.R#L219    ...
R/buildInput.R#L220   # ==================================== ...
R/buildInput.R#L221   # CREATE OUTPUT DIRECTORY EARLY (for l ...
R/buildInput.R#L222   # ==================================== ...
R/buildInput.R#L223    ...
R/buildInput.R#L224   dir_users <- sprintf("%s/output/", out ...
R/buildInput.R#L225   myDir <- dir_users ...
R/buildInput.R#L226   if (!file.exists(myDir)) { ...
R/buildInput.R#L228   } ...
R/buildInput.R#L229   message(paste("Output directory:", myD ...
R/buildInput.R#L230    ...
R/buildInput.R#L231   # ==================================== ...
R/buildInput.R#L232   # STEP 2: GENE VALIDATION (for gene li ...
R/buildInput.R#L233   # ==================================== ...
R/buildInput.R#L234    ...
R/buildInput.R#L235   validated_genes <- NULL ...
R/buildInput.R#L236    ...
R/buildInput.R#L237   if (type_input != "target") { ...
R/buildInput.R#L244       org.Hs.eg.db,  ...
R/buildInput.R#L245       key = gene.List,  ...
R/buildInput.R#L246       columns = "ENTREZID",  ...
R/buildInput.R#L247       keytype = "ALIAS" ...
R/buildInput.R#L249       as.data.frame() %>% ...
R/buildInput.R#L250       dplyr::filter(!is.na(ENTREZID)) %> ...
R/buildInput.R#L251       dplyr::group_by(ALIAS) %>% ...
R/buildInput.R#L252       dplyr::slice(1) %>% ...
R/buildInput.R#L253       dplyr::ungroup() ...
R/buildInput.R#L259       warning(paste("Genes not found in  ...
R/buildInput.R#L261       log_file <- file.path(myDir, 'prep ...
R/buildInput.R#L262       utils::write.table(not_found, file ...
R/buildInput.R#L264       message(paste("List of unrecognize ...
R/buildInput.R#L268       stop("ERROR: No valid genes found  ...
R/buildInput.R#L272                   length(found_genes), " ...
R/buildInput.R#L282       invalid_genes <- my_gene_name %>%  ...
R/buildInput.R#L286        ...
R/buildInput.R#L287       warning(paste("Genes not in refere ...
R/buildInput.R#L289       log_file <- file.path(myDir, 'prep ...
R/buildInput.R#L290       utils::write.table(invalid_genes,  ...
R/buildInput.R#L293       message(paste("List of genes not i ...
R/buildInput.R#L297       dplyr::filter(ENTREZID %in% valid_ ...
R/buildInput.R#L300       stop("ERROR: No genes passed valid ...
R/buildInput.R#L305                   round(difftime(Sys.tim ...
R/buildInput.R#L306                   "seconds\n")) ...
R/buildInput.R#L309       my_gene_name = my_gene_name, ...
R/buildInput.R#L310       valid_entrez_ids = valid_entrez_id ...
R/buildInput.R#L312   } ...
R/buildInput.R#L313    ...
R/buildInput.R#L314   # ==================================== ...
R/buildInput.R#L315   # STEP 3: CREATE TARGET BED ...
R/buildInput.R#L316   # ==================================== ...
R/buildInput.R#L317    ...
R/buildInput.R#L318   message("=== STEP 3: CREATING TARGET B ...
R/buildInput.R#L319   start_time <- Sys.time() ...
R/buildInput.R#L320    ...
R/buildInput.R#L321   if (type_input == "target") { ...
R/buildInput.R#L323   } else { ...
R/buildInput.R#L333       tx_names <- gene_txs$TXNAME ...
R/buildInput.R#L334       coor <- as.data.frame(cds[names(cd ...
R/buildInput.R#L335       if (nrow(coor) == 0) return(NULL) ...
R/buildInput.R#L336       coor$ENTREZID <- gene_txs$GENEID[1 ...
R/buildInput.R#L337       return(coor) ...
R/buildInput.R#L343       stop("No valid transcript coordina ...
R/buildInput.R#L348       dplyr::inner_join(my_gene_name, by ...
R/buildInput.R#L349       dplyr::mutate( ...
R/buildInput.R#L352       ) ...
R/buildInput.R#L355       dplyr::transmute( ...
R/buildInput.R#L360       ) %>% ...
R/buildInput.R#L361       dplyr::distinct() ...
R/buildInput.R#L368       for_bed <- for_bed %>% ...
R/buildInput.R#L371   } ...
R/buildInput.R#L372    ...
R/buildInput.R#L373   message(paste("Created BED with", nrow ...
R/buildInput.R#L374   message(paste("BED creation took:",  ...
R/buildInput.R#L377    ...
R/buildInput.R#L378   # ==================================== ...
R/buildInput.R#L379   # STEP 4: PROCESS COVERAGE DATA ...
R/buildInput.R#L380   # ==================================== ...
R/buildInput.R#L381    ...
R/buildInput.R#L382   message("=== STEP 4: PROCESSING COVERA ...
R/buildInput.R#L383   coverage_time <- Sys.time() ...
R/buildInput.R#L384    ...
R/buildInput.R#L385   message(paste("Input coordinate system ...
R/buildInput.R#L386    ...
R/buildInput.R#L387   # Convert target BED to GRanges (1-bas ...
R/buildInput.R#L388   target_bed_1based <- for_bed ...
R/buildInput.R#L389   if (input_coord_system == "0-based") { ...
R/buildInput.R#L391   } ...
R/buildInput.R#L392    ...
R/buildInput.R#L393   for_grange <- GenomicRanges::makeGRang ...
R/buildInput.R#L396   ) ...
R/buildInput.R#L397    ...
R/buildInput.R#L405                          col.names = c(" ...
R/buildInput.R#L406                          stringsAsFactor ...
R/buildInput.R#L417       stop("No chromosome overlap betwee ...
R/buildInput.R#L422       as.character(GenomicRanges::seqnam ...
R/buildInput.R#L427       distinguish_nucleotides = FALSE, ...
R/buildInput.R#L428       distinguish_strands = FALSE, ...
R/buildInput.R#L429       min_mapq = MAPQ.min, ...
R/buildInput.R#L430       min_base_quality = base.quality, ...
R/buildInput.R#L431       min_nucleotide_depth = 1, ...
R/buildInput.R#L432       max_depth = 150000 ...
R/buildInput.R#L436       message(paste("  Processing:", bas ...
R/buildInput.R#L437       pileup_df <- Rsamtools::pileup(i,  ...
R/buildInput.R#L438       pileup_df <- pileup_df[, -5] ...
R/buildInput.R#L439       pileup_df <- pileup_df[!duplicated ...
R/buildInput.R#L440        ...
R/buildInput.R#L441       pileup_df %>% ...
R/buildInput.R#L458       dplyr::select(-width, -strand) %>% ...
R/buildInput.R#L459       dplyr::distinct() ...
R/buildInput.R#L464   } else if (type_coverage == "bed") { ...
R/buildInput.R#L468       file <- list_coverage[idx] ...
R/buildInput.R#L469       message(paste("Sample", idx, ":",  ...
R/buildInput.R#L470        ...
R/buildInput.R#L471       df <- utils::read.table( ...
R/buildInput.R#L476       ) ...
R/buildInput.R#L477       colnames(df) <- c("seqnames", "sta ...
R/buildInput.R#L478        ...
R/buildInput.R#L479       message(paste("  Raw intervals:",  ...
R/buildInput.R#L480        ...
R/buildInput.R#L481       # Convert to 1-based ...
R/buildInput.R#L482       if (input_coord_system == "0-based ...
R/buildInput.R#L484       } ...
R/buildInput.R#L485        ...
R/buildInput.R#L486       df$interval_id <- paste0("interval ...
R/buildInput.R#L487        ...
R/buildInput.R#L488       df_gr <- GenomicRanges::makeGRange ...
R/buildInput.R#L489       overlaps <- GenomicRanges::findOve ...
R/buildInput.R#L490        ...
R/buildInput.R#L491       if (length(overlaps) == 0) { ...
R/buildInput.R#L494           seqnames = character(),  ...
R/buildInput.R#L495           start = integer(),  ...
R/buildInput.R#L496           end = integer(),  ...
R/buildInput.R#L497           count = numeric(), ...
R/buildInput.R#L498           stringsAsFactors = FALSE ...
R/buildInput.R#L500       } ...
R/buildInput.R#L501        ...
R/buildInput.R#L502       df_gr_overlapping <- df_gr[queryHi ...
R/buildInput.R#L503       for_grange_overlapping <- for_gran ...
R/buildInput.R#L504        ...
R/buildInput.R#L505       df_gr_trimmed <- GenomicRanges::pi ...
R/buildInput.R#L509       ) ...
R/buildInput.R#L510        ...
R/buildInput.R#L511       df_trimmed <- as.data.frame(df_gr_ ...
R/buildInput.R#L512       df_trimmed <- df_trimmed %>% ...
R/buildInput.R#L515        ...
R/buildInput.R#L516       message(paste("  Final intervals:" ...
R/buildInput.R#L517       return(df_trimmed) ...
R/buildInput.R#L523       stop("ERROR: No coverage data over ...
R/buildInput.R#L527       pp <- df_list[[1]] ...
R/buildInput.R#L529       pp <- df_list[[1]] ...
R/buildInput.R#L530       for (i in 2:length(df_list)) { ...
R/buildInput.R#L533       } ...
R/buildInput.R#L537   } ...
R/buildInput.R#L538    ...
R/buildInput.R#L539   # Metadata (OUTSIDE if/else) ...
R/buildInput.R#L540   attr(pp, "coordinate_system") <- "1-ba ...
R/buildInput.R#L541   attr(pp, "trimmed_to_targets") <- TRUE ...
R/buildInput.R#L542   attr(pp, "original_input_system") <- i ...
R/buildInput.R#L543    ...
R/buildInput.R#L544   # Normalize chromosomes (OUTSIDE if/el ...
R/buildInput.R#L545   if (chromosome_notation == "chr") { ...
R/buildInput.R#L547   } else { ...
R/buildInput.R#L549   } ...
R/buildInput.R#L550    ...
R/buildInput.R#L551   # Check missing genes (OUTSIDE if/else ...
R/buildInput.R#L552   if ("SYMBOL" %in% colnames(pp)) { ...
R/buildInput.R#L558       warning(paste(length(missing_genes ...
R/buildInput.R#L559       message("First 20 missing genes:", ...
R/buildInput.R#L560        ...
R/buildInput.R#L561       log_file <- file.path(myDir, 'gene ...
R/buildInput.R#L562       write.table(missing_genes, file =  ...
R/buildInput.R#L563                   quote = FALSE, row.nam ...
R/buildInput.R#L564       message(paste("Full list written t ...
R/buildInput.R#L566       message("SUCCESS: All target genes ...
R/buildInput.R#L568   } ...
R/buildInput.R#L569    ...
R/buildInput.R#L570   message(paste("Final coverage dimensio ...
R/buildInput.R#L571   message(paste("Coverage processing too ...
R/buildInput.R#L574    ...
R/buildInput.R#L575   # ==================================== ...
R/buildInput.R#L576   # STEP 5: CALCULATE STATISTICS ...
R/buildInput.R#L577   # ==================================== ...
R/buildInput.R#L578    ...
R/buildInput.R#L579   message("=== STEP 5: CALCULATING STATI ...
R/buildInput.R#L580   start_time <- Sys.time() ...
R/buildInput.R#L581    ...
R/buildInput.R#L582   ppinp <- as.data.frame(pp) ...
R/buildInput.R#L583   colnames(ppinp)[1:3] <- c("seqnames",  ...
R/buildInput.R#L584    ...
R/buildInput.R#L585   # Sample names ...
R/buildInput.R#L586   n <- length(colnames(ppinp)[-1:-3]) ...
R/buildInput.R#L587   samples <- tools::file_path_sans_ext(b ...
R/buildInput.R#L588    ...
R/buildInput.R#L589   if (length(samples) != n) { ...
R/buildInput.R#L591   } ...
R/buildInput.R#L592    ...
R/buildInput.R#L593   colnames(ppinp)[-1:-3] <- paste0("samp ...
R/buildInput.R#L594    ...
R/buildInput.R#L595   # Create GRanges ...
R/buildInput.R#L596   for_range_pp <- GenomicRanges::makeGRa ...
R/buildInput.R#L599   ) ...
R/buildInput.R#L600    ...
R/buildInput.R#L601   # Find overlaps ...
R/buildInput.R#L602   tp <- GenomicRanges::findOverlaps( ...
R/buildInput.R#L607   ) ...
R/buildInput.R#L608    ...
R/buildInput.R#L609   # Merge coverage with gene annotations ...
R/buildInput.R#L610   sts_df <- data.frame( ...
R/buildInput.R#L613   ) ...
R/buildInput.R#L614    ...
R/buildInput.R#L615   statistiche <- sts_df[!duplicated(sts_ ...
R/buildInput.R#L616   statistiche <- subset( ...
R/buildInput.R#L619   ) ...
R/buildInput.R#L620    ...
R/buildInput.R#L621   colnames(statistiche)[1:3] <- c("chrom ...
R/buildInput.R#L622    ...
R/buildInput.R#L623   merge_g <- dplyr::full_join(target_bed ...
R/buildInput.R#L624                               relationsh ...
R/buildInput.R#L625    ...
R/buildInput.R#L626   col_name <- colnames(merge_g) ...
R/buildInput.R#L627   col.sub <- col_name[grepl("sample_", c ...
R/buildInput.R#L628   merge_g[col.sub] <- sapply(merge_g[col ...
R/buildInput.R#L629    ...
R/buildInput.R#L630   # Calculate interval widths (1-based:  ...
R/buildInput.R#L631   merge_g$width <- merge_g$end.x - merge ...
R/buildInput.R#L632    ...
R/buildInput.R#L633   # Prepare per-sample data ...
R/buildInput.R#L634   x <- lapply(col.sub, function(i) { ...
R/buildInput.R#L636       dplyr::select("chromosome", "start ...
R/buildInput.R#L637                    tidyselect::all_of(i) ...
R/buildInput.R#L641   }) ...
R/buildInput.R#L642    ...
R/buildInput.R#L643   # Calculate statistics with proper wei ...
R/buildInput.R#L644   statistical_operation <- function(df)  ...
R/buildInput.R#L648       return(data.frame( ...
R/buildInput.R#L658       )) ...
R/buildInput.R#L662       dplyr::group_by(SYMBOL, sample) %> ...
R/buildInput.R#L663       dplyr::summarize( ...
R/buildInput.R#L670                                       su ...
R/buildInput.R#L672       ) %>% ...
R/buildInput.R#L673       as.data.frame() %>% ...
R/buildInput.R#L674       dplyr::mutate_if(is.numeric, round ...
R/buildInput.R#L675   } ...
R/buildInput.R#L676    ...
R/buildInput.R#L677   stat_summ <- do.call(rbind, lapply(x,  ...
R/buildInput.R#L678    ...
R/buildInput.R#L679   message(paste("Statistics computation  ...
R/buildInput.R#L682    ...
R/buildInput.R#L683   # ==================================== ...
R/buildInput.R#L684   # STEP 6: ADD OPTIONAL ANNOTATIONS ...
R/buildInput.R#L685   # ==================================== ...
R/buildInput.R#L686    ...
R/buildInput.R#L687   if (!is.null(annotation_file)) { ...
R/buildInput.R#L694       warning(paste("Annotation file not ...
R/buildInput.R#L696       tryCatch({ ...
R/buildInput.R#L698           annotation_file,  ...
R/buildInput.R#L699           header = TRUE,  ...
R/buildInput.R#L700           sep = "\t",  ...
R/buildInput.R#L701           stringsAsFactors = FALSE, ...
R/buildInput.R#L702           quote = "" ...
R/buildInput.R#L706           warning("Annotation file must  ...
R/buildInput.R#L708           message(paste("Loaded", nrow(o ...
R/buildInput.R#L709            ...
R/buildInput.R#L710           stat_summ <- merge( ...
R/buildInput.R#L715           ) ...
R/buildInput.R#L716            ...
R/buildInput.R#L717           message("Annotations added suc ...
R/buildInput.R#L718           message(paste("Annotation took ...
R/buildInput.R#L719                        round(difftime(Sy ...
R/buildInput.R#L720                        "seconds\n")) ...
R/buildInput.R#L722       }, error = function(e) { ...
R/buildInput.R#L724       }) ...
R/buildInput.R#L726   } ...
R/buildInput.R#L727    ...
R/buildInput.R#L728   # ==================================== ...
R/buildInput.R#L729   # STEP 7: WRITE OUTPUTS ...
R/buildInput.R#L730   # ==================================== ...
R/buildInput.R#L731    ...
R/buildInput.R#L732   message("=== STEP 7: WRITING OUTPUTS = ...
R/buildInput.R#L733    ...
R/buildInput.R#L734   # Directory already created at the beg ...
R/buildInput.R#L735   # Generate timestamp for filenames ...
R/buildInput.R#L736   timestamp <- format(Sys.time(), "%a_%b ...
R/buildInput.R#L737    ...
R/buildInput.R#L738   # Rename columns before writing ...
R/buildInput.R#L739   pp_output <- pp ...
R/buildInput.R#L741   if ("SYMBOL" %in% colnames(pp_output)) ...
R/buildInput.R#L742   message("Removing SYMBOL from coverage ...
R/buildInput.R#L743   pp_output <- pp_output %>% dplyr::sele ...
R/buildInput.R#L744   } ...
R/buildInput.R#L746   # 1. Rename first column from "seqname ...
R/buildInput.R#L747   colnames(pp_output)[1] <- "chromosome" ...
R/buildInput.R#L749   # 2. Rename count columns to include f ...
R/buildInput.R#L750   sample_names <- tools::file_path_sans_ ...
R/buildInput.R#L751   count_cols <- colnames(pp_output)[-(1: ...
R/buildInput.R#L753   # Create new column names with "count_ ...
R/buildInput.R#L754   new_count_names <- paste0("count_", sa ...
R/buildInput.R#L756   # Apply new names to count columns ...
R/buildInput.R#L757   colnames(pp_output)[4:ncol(pp_output)] ...
R/buildInput.R#L758   # Write coverage file ...
R/buildInput.R#L759   coverage_file <- file.path(myDir, past ...
R/buildInput.R#L760   utils::write.table( ...
R/buildInput.R#L768   ) ...
R/buildInput.R#L769   message(paste("Coverage data written t ...
R/buildInput.R#L770    ...
R/buildInput.R#L771   # Write statistics file ...
R/buildInput.R#L772   stats_file <- file.path(myDir, paste0( ...
R/buildInput.R#L773   utils::write.table( ...
R/buildInput.R#L782   ) ...
R/buildInput.R#L783   message(paste("Statistical summary wri ...
R/buildInput.R#L784    ...
R/buildInput.R#L785   message("\n=== ANALYSIS COMPLETE ===") ...
R/buildInput.R#L786   message(Sys.time()) ...
R/buildInput.R#L787   message("Output directory: ", myDir) ...
R/buildInput.R#L788   cat("Total script execution:",round(di ...
R/buildInput.R#L790   # Return results invisibly ...
R/buildInput.R#L791   invisible(list( ...
R/buildInput.R#L795   )) ...
R/getAnnotationFiles.R#L14    ...
R/getAnnotationFiles.R#L15   # Match argument ...
R/getAnnotationFiles.R#L16   assembly <- match.arg(assembly, severa ...
R/getAnnotationFiles.R#L17    ...
R/getAnnotationFiles.R#L18   if (verbose) { ...
R/getAnnotationFiles.R#L21   } ...
R/getAnnotationFiles.R#L22    ...
R/getAnnotationFiles.R#L23   # Define download URLs and cache direc ...
R/getAnnotationFiles.R#L24   base_url <- "https://zenodo.org/record ...
R/getAnnotationFiles.R#L25   cache_dir <- rappdirs::user_cache_dir( ...
R/getAnnotationFiles.R#L26    ...
R/getAnnotationFiles.R#L27   # Create cache directory if it doesn't ...
R/getAnnotationFiles.R#L28   if (!dir.exists(cache_dir)) { ...
R/getAnnotationFiles.R#L31   } ...
R/getAnnotationFiles.R#L32    ...
R/getAnnotationFiles.R#L33   # File definitions ...
R/getAnnotationFiles.R#L34   files <- list( ...
R/getAnnotationFiles.R#L36       gz = "sorted_hg19.bed.gz", ...
R/getAnnotationFiles.R#L37       tbi = "sorted_hg19.bed.gz.tbi" ...
R/getAnnotationFiles.R#L40       gz = "sorted_hg38.bed.gz", ...
R/getAnnotationFiles.R#L41       tbi = "sorted_hg38.bed.gz.tbi" ...
R/getAnnotationFiles.R#L43   ) ...
R/getAnnotationFiles.R#L44    ...
R/getAnnotationFiles.R#L45   # Download function ...
R/getAnnotationFiles.R#L46  download_file <- function(assembly_name ...
R/getAnnotationFiles.R#L47   filename <- files[[assembly_name]][fil ...
R/getAnnotationFiles.R#L48   local_path <- file.path(cache_dir, fil ...
R/getAnnotationFiles.R#L49    ...
R/getAnnotationFiles.R#L50   # Check if file already exists ...
R/getAnnotationFiles.R#L51   if (file.exists(local_path)) { ...
R/getAnnotationFiles.R#L54   } ...
R/getAnnotationFiles.R#L55    ...
R/getAnnotationFiles.R#L56   url <- paste0(base_url, filename) ...
R/getAnnotationFiles.R#L57   if (verbose) { ...
R/getAnnotationFiles.R#L60   } ...
R/getAnnotationFiles.R#L61    ...
R/getAnnotationFiles.R#L62   # Save and modify timeout ...
R/getAnnotationFiles.R#L63   old_timeout <- getOption("timeout") ...
R/getAnnotationFiles.R#L64   options(timeout = max(10000, old_timeo ...
R/getAnnotationFiles.R#L65   on.exit(options(timeout = old_timeout) ...
R/getAnnotationFiles.R#L66    ...
R/getAnnotationFiles.R#L67   tryCatch({ ...
R/getAnnotationFiles.R#L72       stop("Download completed but file  ...
R/getAnnotationFiles.R#L78   }, error = function(e) { ...
R/getAnnotationFiles.R#L81       file.remove(local_path) ...
R/getAnnotationFiles.R#L82       if (verbose) cat("Removed incomple ...
R/getAnnotationFiles.R#L86   }) ...
R/getAnnotationFiles.R#L88    ...
R/getAnnotationFiles.R#L89   # Download files for requested assembl ...
R/getAnnotationFiles.R#L90   result <- list() ...
R/getAnnotationFiles.R#L91    ...
R/getAnnotationFiles.R#L92   for (asm in assembly) { ...
R/getAnnotationFiles.R#L100       result[[asm]] <- c(gz_path, tbi_pa ...
R/getAnnotationFiles.R#L102       warning("Failed to download files  ...
R/getAnnotationFiles.R#L103       result[[asm]] <- NULL ...
R/getAnnotationFiles.R#L105   } ...
R/getAnnotationFiles.R#L106    ...
R/getAnnotationFiles.R#L107   if (verbose) { ...
R/getAnnotationFiles.R#L111   } ...
R/getAnnotationFiles.R#L112    ...
R/getAnnotationFiles.R#L113   return(result) ...
R/run.uncoverapp.R#L61   appDir <- system.file("shiny-dir", pac ...
R/run.uncoverapp.R#L62   if (appDir == "") { ...
R/run.uncoverapp.R#L64   } ...
R/run.uncoverapp.R#L65   shiny::runApp(appDir) ...
R/run.uncoverapp.R#L86   if (missing(where)) { ...
R/run.uncoverapp.R#L89   } else { ...
R/run.uncoverapp.R#L91       match.arg(where, c("browser", "vie ...
R/run.uncoverapp.R#L92       browser = get(".rs.invokeShinyWind ...
R/run.uncoverapp.R#L93       viewer = get(".rs.invokeShinyPaneV ...
R/run.uncoverapp.R#L94       window = get(".rs.invokeShinyWindo ...
R/run.uncoverapp.R#L97   } ...
R/run.uncoverapp.R#L122   if (missing(where)) { ...
R/run.uncoverapp.R#L124   } else { ...
R/run.uncoverapp.R#L126   } ...
R/setup.R#L20   cat("\n=============================== ...
R/setup.R#L21   cat("  UncoverApp Setup                ...
R/setup.R#L22   cat("================================= ...
R/setup.R#L23   cat("Checking annotation files...\n\n" ...
R/setup.R#L24    ...
R/setup.R#L25   cache_dir <- rappdirs::user_cache_dir( ...
R/setup.R#L26   existing_files <- if (dir.exists(cache ...
R/setup.R#L28   } else { ...
R/setup.R#L30   } ...
R/setup.R#L31    ...
R/setup.R#L32   if (length(existing_files) >= 2) { ...
R/setup.R#L36       cat("  -", basename(f), "\n") ...
R/setup.R#L40   } ...
R/setup.R#L41    ...
R/setup.R#L42   cat("Downloading annotation files...\n ...
R/setup.R#L43   cat("This will take ~10-20 minutes (~1 ...
R/setup.R#L44    ...
R/setup.R#L45   pb <- txtProgressBar(min = 0, max = 10 ...
R/setup.R#L46    ...
R/setup.R#L47   for (i in 1:10) { ...
R/setup.R#L50   } ...
R/setup.R#L51    ...
R/setup.R#L52   result <- getAnnotationFiles(assembly  ...
R/setup.R#L53    ...
R/setup.R#L54   setTxtProgressBar(pb, 100) ...
R/setup.R#L55   close(pb) ...
R/setup.R#L56    ...
R/setup.R#L57   cat("\n\n[OK] Setup complete!\n") ...
R/setup.R#L58   cat("Run: uncoverappLib.run()\n\n") ...
R/setup.R#L59    ...
R/setup.R#L60   invisible(result) ...
R/setup.R#L77   cache_dir <- rappdirs::user_cache_dir( ...
R/setup.R#L78    ...
R/setup.R#L79   if (!dir.exists(cache_dir)) { ...
R/setup.R#L82   } ...
R/setup.R#L83    ...
R/setup.R#L84   files <- list.files(cache_dir, pattern ...
R/setup.R#L85    ...
R/setup.R#L86   if (length(files) == 0) { ...
R/setup.R#L88   } else { ...
R/setup.R#L91       cat("  [OK]", basename(f), "-", ro ...
R/setup.R#L94   } ...
R/setup.R#L95    ...
R/setup.R#L96   invisible(files) ...
vignettes/uncoverapp_introduction.Rmd#L17   collapse = TRUE, ...
vignettes/uncoverapp_introduction.Rmd#L18   comment = "#>", ...
vignettes/uncoverapp_introduction.Rmd#L19   fig.width = 7, ...
vignettes/uncoverapp_introduction.Rmd#L20   fig.height = 5 ...
vignettes/uncoverapp_introduction.Rmd#L49   "Gviz", "Homo.sapiens", "org.Hs.eg.db" ...
vignettes/uncoverapp_introduction.Rmd#L50   "TxDb.Hsapiens.UCSC.hg19.knownGene", ...
vignettes/uncoverapp_introduction.Rmd#L51   "TxDb.Hsapiens.UCSC.hg38.knownGene", ...
vignettes/uncoverapp_introduction.Rmd#L52   "EnsDb.Hsapiens.v75", "EnsDb.Hsapiens. ...
vignettes/uncoverapp_introduction.Rmd#L53   "GenomicRanges", "AnnotationDbi" ...
vignettes/uncoverapp_introduction.Rmd#L115    - Reference genome (hg19/hg38) ...
vignettes/uncoverapp_introduction.Rmd#L116    - Mapping quality (MAPQ) ...
vignettes/uncoverapp_introduction.Rmd#L117    - Base quality ...
vignettes/uncoverapp_introduction.Rmd#L118    - Coordinate system (0-based/1-based) ...
vignettes/uncoverapp_introduction.Rmd#L126    - Coverage threshold (e.g., 20x) ...
vignettes/uncoverapp_introduction.Rmd#L127    - Sample name ...
vignettes/uncoverapp_introduction.Rmd#L128    - Filter by: gene/chromosome/region ...
vignettes/uncoverapp_introduction.Rmd#L131    - Low-coverage positions table ...
vignettes/uncoverapp_introduction.Rmd#L132    - Gene coverage plot (Gviz) ...
vignettes/uncoverapp_introduction.Rmd#L133    - UCSC gene coordinates ...
vignettes/uncoverapp_introduction.Rmd#L140    - Population frequencies (gnomAD) ...
vignettes/uncoverapp_introduction.Rmd#L141    - Pathogenicity scores (CADD, SIFT, P ...
vignettes/uncoverapp_introduction.Rmd#L142    - ClinVar classifications ...
vignettes/uncoverapp_introduction.Rmd#L143    - OMIM associations ...
vignettes/uncoverapp_introduction.Rmd#L156   gene_list = "genes.txt", ...
vignettes/uncoverapp_introduction.Rmd#L157   bam_list = "samples.txt", ...
vignettes/uncoverapp_introduction.Rmd#L158   genome = "hg19", ...
vignettes/uncoverapp_introduction.Rmd#L159   mapq = 20, ...
vignettes/uncoverapp_introduction.Rmd#L160   base_qual = 20 ...
vignettes/uncoverapp_introduction.Rmd#L165   coverage_df = coverage_data, ...
vignettes/uncoverapp_introduction.Rmd#L166   threshold = 20, ...
vignettes/uncoverapp_introduction.Rmd#L167   genome = "hg19" ...
vignettes/uncoverapp_technical.Rmd#L17   collapse = TRUE, ...
vignettes/uncoverapp_technical.Rmd#L18   comment = "#>" ...
vignettes/uncoverapp_technical.Rmd#L64    ...
vignettes/uncoverapp_technical.Rmd#L65   # Step 1: Get gene coordinates ...
vignettes/uncoverapp_technical.Rmd#L66   gene_ranges <- genes_to_genomic_ranges ...
vignettes/uncoverapp_technical.Rmd#L67    ...
vignettes/uncoverapp_technical.Rmd#L68   # Step 2: Extract coverage ...
vignettes/uncoverapp_technical.Rmd#L69   if (input_type == "bam") { ...
vignettes/uncoverapp_technical.Rmd#L71   } else { ...
vignettes/uncoverapp_technical.Rmd#L73   } ...
vignettes/uncoverapp_technical.Rmd#L74    ...
vignettes/uncoverapp_technical.Rmd#L75   # Step 3: Normalize coordinates (alway ...
vignettes/uncoverapp_technical.Rmd#L76   coverage <- normalize_coordinates(cove ...
vignettes/uncoverapp_technical.Rmd#L77    ...
vignettes/uncoverapp_technical.Rmd#L78   # Step 4: Merge samples ...
vignettes/uncoverapp_technical.Rmd#L79   merged <- merge_sample_coverage(covera ...
vignettes/uncoverapp_technical.Rmd#L80    ...
vignettes/uncoverapp_technical.Rmd#L81   return(merged) ...
vignettes/uncoverapp_technical.Rmd#L97    ...
vignettes/uncoverapp_technical.Rmd#L98   # Get base data ...
vignettes/uncoverapp_technical.Rmd#L99   data <- coverage_input() ...
vignettes/uncoverapp_technical.Rmd#L100    ...
vignettes/uncoverapp_technical.Rmd#L101   # Apply threshold filter ...
vignettes/uncoverapp_technical.Rmd#L102   low_cov <- data[data$coverage <= thres ...
vignettes/uncoverapp_technical.Rmd#L103    ...
vignettes/uncoverapp_technical.Rmd#L104   # Apply genomic filter ...
vignettes/uncoverapp_technical.Rmd#L105   if (filter_mode == "gene") { ...
vignettes/uncoverapp_technical.Rmd#L107   } else if (filter_mode == "chromosome" ...
vignettes/uncoverapp_technical.Rmd#L109   } else if (filter_mode == "region") { ...
vignettes/uncoverapp_technical.Rmd#L111   } ...
vignettes/uncoverapp_technical.Rmd#L112    ...
vignettes/uncoverapp_technical.Rmd#L113   return(low_cov) ...
vignettes/uncoverapp_technical.Rmd#L129    ...
vignettes/uncoverapp_technical.Rmd#L130   # Step 1: Get annotation file ...
vignettes/uncoverapp_technical.Rmd#L131   dbNSFP_file <- get_annotation_file(gen ...
vignettes/uncoverapp_technical.Rmd#L132    ...
vignettes/uncoverapp_technical.Rmd#L133   # Step 2: Create Tabix queries ...
vignettes/uncoverapp_technical.Rmd#L134   queries <- create_tabix_queries(positi ...
vignettes/uncoverapp_technical.Rmd#L135    ...
vignettes/uncoverapp_technical.Rmd#L136   # Step 3: Query in parallel (chunked) ...
vignettes/uncoverapp_technical.Rmd#L137   annotations <- parallel_tabix_query( ...
vignettes/uncoverapp_technical.Rmd#L141   ) ...
vignettes/uncoverapp_technical.Rmd#L142    ...
vignettes/uncoverapp_technical.Rmd#L143   # Step 4: Parse and merge ...
vignettes/uncoverapp_technical.Rmd#L144   parsed <- parse_dbNSFP_fields(annotati ...
vignettes/uncoverapp_technical.Rmd#L145   result <- merge(positions, parsed, by  ...
vignettes/uncoverapp_technical.Rmd#L146    ...
vignettes/uncoverapp_technical.Rmd#L147   return(result) ...
vignettes/uncoverapp_technical.Rmd#L163    ...
vignettes/uncoverapp_technical.Rmd#L164   # Track 1: Ideogram ...
vignettes/uncoverapp_technical.Rmd#L165   itrack <- IdeogramTrack(genome = genom ...
vignettes/uncoverapp_technical.Rmd#L166    ...
vignettes/uncoverapp_technical.Rmd#L167   # Track 2: Genome axis ...
vignettes/uncoverapp_technical.Rmd#L168   gtrack <- GenomeAxisTrack() ...
vignettes/uncoverapp_technical.Rmd#L169    ...
vignettes/uncoverapp_technical.Rmd#L170   # Track 3: Gene annotations ...
vignettes/uncoverapp_technical.Rmd#L171   grtrack <- GeneRegionTrack( ...
vignettes/uncoverapp_technical.Rmd#L177   ) ...
vignettes/uncoverapp_technical.Rmd#L178    ...
vignettes/uncoverapp_technical.Rmd#L179   # Track 4: Coverage (low + high overla ...
vignettes/uncoverapp_technical.Rmd#L180   dtrack_low <- DataTrack( ...
vignettes/uncoverapp_technical.Rmd#L184   ) ...
vignettes/uncoverapp_technical.Rmd#L185    ...
vignettes/uncoverapp_technical.Rmd#L186   dtrack_high <- DataTrack( ...
vignettes/uncoverapp_technical.Rmd#L190   ) ...
vignettes/uncoverapp_technical.Rmd#L191    ...
vignettes/uncoverapp_technical.Rmd#L192   overlay <- OverlayTrack(trackList = li ...
vignettes/uncoverapp_technical.Rmd#L193    ...
vignettes/uncoverapp_technical.Rmd#L194   # Plot all tracks ...
vignettes/uncoverapp_technical.Rmd#L195   plotTracks( ...
vignettes/uncoverapp_technical.Rmd#L200   ) ...
vignettes/uncoverapp_technical.Rmd#L224   # Heavy computation here ...
vignettes/uncoverapp_technical.Rmd#L225   # Won't run until button is pressed ...
vignettes/uncoverapp_technical.Rmd#L296   # Use Rsamtools::TabixFile ...
vignettes/uncoverapp_technical.Rmd#L297   tf <- TabixFile(anno_file) ...
vignettes/uncoverapp_technical.Rmd#L298    ...
vignettes/uncoverapp_technical.Rmd#L299   # Create GRanges ...
vignettes/uncoverapp_technical.Rmd#L300   gr <- GRanges( ...
vignettes/uncoverapp_technical.Rmd#L303   ) ...
vignettes/uncoverapp_technical.Rmd#L304    ...
vignettes/uncoverapp_technical.Rmd#L305   # Query ...
vignettes/uncoverapp_technical.Rmd#L306   result <- scanTabix(tf, param = gr) ...
vignettes/uncoverapp_technical.Rmd#L307    ...
vignettes/uncoverapp_technical.Rmd#L308   # Parse and return ...
vignettes/uncoverapp_technical.Rmd#L309   parsed <- parse_annotation_result(resu ...
vignettes/uncoverapp_technical.Rmd#L310   return(parsed) ...
vignettes/uncoverapp_technical.Rmd#L324   # Process coverage data for custom vis ...
vignettes/uncoverapp_technical.Rmd#L325   data <- filtered_low() ...
vignettes/uncoverapp_technical.Rmd#L326   processed <- custom_processing(data) ...
vignettes/uncoverapp_technical.Rmd#L327   return(processed) ...
vignettes/uncoverapp_technical.Rmd#L332   data <- custom_plot_data() ...
vignettes/uncoverapp_technical.Rmd#L333    ...
vignettes/uncoverapp_technical.Rmd#L334   # Use ggplot2, plotly, or base R ...
vignettes/uncoverapp_technical.Rmd#L335   ggplot(data, aes(x = position, y = cov ...
vignettes/uncoverapp_technical.Rmd#L351    ...
vignettes/uncoverapp_technical.Rmd#L352   sample1 <- get_sample_data(mydata(), i ...
vignettes/uncoverapp_technical.Rmd#L353   sample2 <- get_sample_data(mydata(), i ...
vignettes/uncoverapp_technical.Rmd#L354    ...
vignettes/uncoverapp_technical.Rmd#L355   # Create contingency table ...
vignettes/uncoverapp_technical.Rmd#L356   table <- matrix(c( ...
vignettes/uncoverapp_technical.Rmd#L361   ), nrow = 2) ...
vignettes/uncoverapp_technical.Rmd#L362    ...
vignettes/uncoverapp_technical.Rmd#L363   # Run test ...
vignettes/uncoverapp_technical.Rmd#L364   test_result <- fisher.test(table) ...
vignettes/uncoverapp_technical.Rmd#L365    ...
vignettes/uncoverapp_technical.Rmd#L366   return(test_result) ...
vignettes/uncoverapp_technical.Rmd#L377   # Setup test data ...
vignettes/uncoverapp_technical.Rmd#L378   test_bam <- system.file("extdata", "ex ...
vignettes/uncoverapp_technical.Rmd#L379   test_genes <- c("POLG") ...
vignettes/uncoverapp_technical.Rmd#L380    ...
vignettes/uncoverapp_technical.Rmd#L381   # Run function ...
vignettes/uncoverapp_technical.Rmd#L382   result <- buildInput( ...
vignettes/uncoverapp_technical.Rmd#L386   ) ...
vignettes/uncoverapp_technical.Rmd#L387    ...
vignettes/uncoverapp_technical.Rmd#L388   # Assertions ...
vignettes/uncoverapp_technical.Rmd#L389   expect_s3_class(result, "data.frame") ...
vignettes/uncoverapp_technical.Rmd#L390   expect_true("SYMBOL" %in% colnames(res ...
vignettes/uncoverapp_technical.Rmd#L391   expect_true(all(result$SYMBOL %in% tes ...
vignettes/uncoverapp_technical.Rmd#L400    ...
vignettes/uncoverapp_technical.Rmd#L401   # 1. Build input ...
vignettes/uncoverapp_technical.Rmd#L402   coverage <- buildInput(...) ...
vignettes/uncoverapp_technical.Rmd#L403    ...
vignettes/uncoverapp_technical.Rmd#L404   # 2. Filter ...
vignettes/uncoverapp_technical.Rmd#L405   low_cov <- coverage[coverage$sample_1  ...
vignettes/uncoverapp_technical.Rmd#L406    ...
vignettes/uncoverapp_technical.Rmd#L407   # 3. Annotate ...
vignettes/uncoverapp_technical.Rmd#L408   annotated <- annotate_all_lowcov(low_c ...
vignettes/uncoverapp_technical.Rmd#L409    ...
vignettes/uncoverapp_technical.Rmd#L410   # 4. Check output ...
vignettes/uncoverapp_technical.Rmd#L411   expect_true(nrow(annotated) > 0) ...
vignettes/uncoverapp_technical.Rmd#L412   expect_true("CADD_phred" %in% colnames ...
vignettes/uncoverapp_technical.Rmd#L426   chunk <- data[i:min(i + chunk_size - 1 ...
vignettes/uncoverapp_technical.Rmd#L427   process_chunk(chunk) ...
vignettes/uncoverapp_technical.Rmd#L428   gc()  # Force garbage collection ...
vignettes/uncoverapp_technical.Rmd#L443   mean_cov = mean(coverage), ...
vignettes/uncoverapp_technical.Rmd#L444   median_cov = median(coverage) ...
vignettes/uncoverapp_technical.Rmd#L462   process_sample(coverage_data, sample) ...
vignettes/uncoverapp_technical.Rmd#L473   chr = c("chr1", "chr1", "chr2"), ...
vignettes/uncoverapp_technical.Rmd#L474   pos = c(1000, 1001, 2000), ...
vignettes/uncoverapp_technical.Rmd#L475   coverage = c(15, 25, 30), ...
vignettes/uncoverapp_technical.Rmd#L476   stringsAsFactors = FALSE ...
vignettes/uncoverapp_technical.Rmd#L497   chr = "chr1", ...
vignettes/uncoverapp_technical.Rmd#L498   start = 999,  # 0-based ...
vignettes/uncoverapp_technical.Rmd#L499   end = 1000 ...
vignettes/uncoverapp_technical.Rmd#L512   chr = c("chr1", "chr1", "chr2"), ...
vignettes/uncoverapp_technical.Rmd#L513   pos = c(1000, 1001, 2000), ...
vignettes/uncoverapp_technical.Rmd#L514   gene = c("BRCA1", "BRCA1", "TP53") ...
vignettes/uncoverapp_technical.Rmd#L525   chr = c("chr1", "chr1", "chr2", "chr2" ...
vignettes/uncoverapp_technical.Rmd#L526   coverage = c(15, 25, 30, 8) ...
vignettes/uncoverapp_technical.Rmd#L538                          ifelse(coverage ...
vignettes/uncoverapp_technical.Rmd#L546   start = c(1000, 2000, 3000), ...
vignettes/uncoverapp_technical.Rmd#L547   end = c(1100, 2050, 3200) ...
vignettes/uncoverapp_technical.Rmd#L557   position = c(1000, 1001, 1002), ...
vignettes/uncoverapp_technical.Rmd#L558   sample_A = c(25, 30, 15), ...
vignettes/uncoverapp_technical.Rmd#L559   sample_B = c(20, 28, 12) ...
vignettes/uncoverapp_technical.Rmd#L578   region = c("exon1", "exon1", "exon2",  ...
vignettes/uncoverapp_technical.Rmd#L579   coverage = c(25, 30, 15, 20) ...
vignettes/uncoverapp_technical.Rmd#L594   pos = 1000:1005, ...
vignettes/uncoverapp_technical.Rmd#L595   cov = c(12, 25, 8, 30, 15, 22) ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration... OK
